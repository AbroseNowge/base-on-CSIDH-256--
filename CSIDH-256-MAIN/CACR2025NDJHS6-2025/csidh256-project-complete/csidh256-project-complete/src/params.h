#ifndef PARAMS_H
#define PARAMS_H

#include <stdint.h>

// CSIDH-256 参数（比 512 简单很多）
#define LIMBS 4  // 256 / 64 = 4

typedef struct {
    uint64_t limbs[LIMBS];
} bigint256;

// ============================================================================
// 自定义CSIDH-256 素数 p（非官方标准参数）
// ============================================================================
// 警告：此素数p是自定义选择，不是官方CSIDH标准素数
//
// 官方CSIDH使用经过充分验证的素数，满足严格的安全要求
// 此自定义素数p满足基本条件：p+1能被所有小素数l_i整除
// 但未经过完整的安全验证，不建议用于生产环境
//
// 如需标准CSIDH参数，请参考官方实现
// ============================================================================
static const uint64_t CSIDH256_P[4] = {
    0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF,
    0xFFFFFFFFFFFFFFFF,
    0x1FFFFFFFFFFFFFFF  // 注意最高位
};

// 验证函数：检查p+1是否能被l整除
// 这个函数在运行时验证参数的正确性

// 小素数列表（37个，比512的74个少一半）
#define NUM_PRIMES 37
static const int PRIMES[NUM_PRIMES] = {
    3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53,
    59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113,
    127, 131, 137, 139, 149, 151, 157, 163
};

#endif
